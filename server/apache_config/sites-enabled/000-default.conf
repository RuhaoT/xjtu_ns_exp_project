<VirtualHost *:80>

    DocumentRoot "${APACHE_SERVER_DIR}/doc_root"

    DirectoryIndex index.html

    <Directory "${APACHE_SERVER_DIR}/doc_root">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    <Directory "${APACHE_SERVER_DIR}/doc_root/test">
        Options Indexes FollowSymLinks
        AllowOverride None
        AuthType Basic
        AuthName "Test Area"
        AuthUserFile "${APACHE_SERVER_DIR}/apache_config/.adminpwd"
        Require valid-user
    </Directory>

    ScriptAlias /upload ${APACHE_SERVER_DIR}/doc_root/cgi-bin/upload.py
    <Directory "${APACHE_SERVER_DIR}/doc_root/cgi-bin">
        AllowOverride None
        Options +ExecCGI
        Require all granted
        SetHandler cgi-script
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
</VirtualHost>

<VirtualHost *:443>

    DocumentRoot "${APACHE_SERVER_DIR}/doc_root"

    DirectoryIndex index.html

    <Directory "${APACHE_SERVER_DIR}/doc_root">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    <Directory "${APACHE_SERVER_DIR}/doc_root/test">
        Options Indexes FollowSymLinks
        AllowOverride None
        AuthType Basic
        AuthName "Test Area"
        AuthUserFile "${APACHE_SERVER_DIR}/apache_config/.adminpwd"
        Require valid-user
    </Directory>

    ScriptAlias /upload ${APACHE_SERVER_DIR}/doc_root/cgi-bin/upload.py
    <Directory "${APACHE_SERVER_DIR}/doc_root/cgi-bin">
        AllowOverride None
        Options +ExecCGI
        Require all granted
        SetHandler cgi-script
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error_ssl.log
    CustomLog ${APACHE_LOG_DIR}/access_ssl.log combined
    SSLEngine on
    SSLCertificateFile ${APACHE_SERVER_DIR}/apache_config/ssl/server.crt
    SSLCertificateKeyFile ${APACHE_SERVER_DIR}/apache_config/ssl/server.key

</VirtualHost>
